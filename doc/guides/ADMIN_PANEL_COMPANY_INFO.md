# ğŸ¢ Panel Administracyjny - Dane Firmy

## ğŸ“ Lokalizacja

**URL:** `/admin/company-settings`

**DostÄ™p:** `Owner` lub `SuperAdmin`

---

## ğŸ¨ WyglÄ…d Panelu

### **Sekcja: Informacje podstawowe**

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Informacje podstawowe                                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘ â„¹ï¸  Te dane bÄ™dÄ… automatycznie uwzglÄ™dniane              â•‘
â•‘     w umowach PDF wysyÅ‚anych do klientÃ³w!                â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Nazwa firmy *                                        â”‚ â•‘
â•‘ â”‚ [WypoÅ¼yczalnia 'Narty & Snowboard' Sp. z o.o.]      â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Adres                                                â”‚ â•‘
â•‘ â”‚ [ul. KrupÃ³wki 12/3                            ]      â”‚ â•‘
â•‘ â”‚ [34-500 Zakopane                              ]      â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Telefon                                              â”‚ â•‘
â•‘ â”‚ [+48 18 201 50 00]                                   â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Email                                                â”‚ â•‘
â•‘ â”‚ [kontakt@nartyzakopane.pl]                           â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ NIP                                                  â”‚ â•‘
â•‘ â”‚ [7362614562]                      10 cyfr           â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ REGON                            âœ¨ NOWE!           â”‚ â•‘
â•‘ â”‚ [012345678]                       9 lub 14 cyfr     â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Forma prawna                                         â”‚ â•‘
â•‘ â”‚ [Sp. z o.o.]                                         â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Godziny otwarcia                                     â”‚ â•‘
â•‘ â”‚ [Pn-Pt: 9:00-18:00, Sb-Nd: 10:00-16:00]            â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘ â”‚ Opis                                                 â”‚ â•‘
â•‘ â”‚ [Profesjonalna wypoÅ¼yczalnia sprzÄ™tu...      ]      â”‚ â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ”§ FunkcjonalnoÅ›ci

### âœ… **Pola formularza:**

| Pole | Typ | Wymagane | Opis |
|------|-----|----------|------|
| **Nazwa firmy** | Text | âœ… Tak | PeÅ‚na nazwa firmy (z Tenant) |
| **Adres** | Text (multi) | âŒ Nie | PeÅ‚ny adres siedziby |
| **Telefon** | Text | âŒ Nie | Telefon kontaktowy |
| **Email** | Email | âŒ Nie | Email kontaktowy |
| **NIP** | Text (max 20) | âŒ Nie | 10 cyfr |
| **REGON** | Text (max 14) | âŒ Nie | 9 lub 14 cyfr |
| **Forma prawna** | Text | âŒ Nie | Np. "Sp. z o.o.", "JDG" |
| **Godziny otwarcia** | Text | âŒ Nie | Np. "Pn-Pt: 9-18" |
| **Opis** | Text (multi) | âŒ Nie | KrÃ³tki opis firmy |

### ğŸ“„ **WpÅ‚yw na umowy PDF:**

Po wypeÅ‚nieniu tych danych, kaÅ¼da umowa PDF wysÅ‚ana do klienta bÄ™dzie zawieraÄ‡:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ DANE WYPOÅ»YCZALNI                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ WypoÅ¼yczalnia 'Narty & Snowboard' Sp. z o.o.  â•‘
â•‘ Adres: ul. KrupÃ³wki 12/3, 34-500 Zakopane     â•‘
â•‘ NIP: 7362614562                                â•‘
â•‘ REGON: 012345678                               â•‘
â•‘ Email: kontakt@nartyzakopane.pl                â•‘
â•‘ Tel: +48 18 201 50 00                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Footer PDF:**
```
WypoÅ¼yczalnia 'Narty & Snowboard' Sp. z o.o. | Wygenerowano: 07.10.2025
kontakt@nartyzakopane.pl | +48 18 201 50 00
```

---

## ğŸ’¾ Zapisywanie

### **Logika zapisu:**

1. **Update Tenant:**
   - Aktualizacja `tenant.Name` (nazwa firmy)

2. **Update lub Create CompanyInfo:**
   - Sprawdza czy istnieje `CompanyInfo` dla danego `TenantId`
   - JeÅ›li istnieje â†’ UPDATE wszystkich pÃ³l + `UpdatedAtUtc`
   - JeÅ›li nie â†’ CREATE nowy rekord z wszystkimi polami

3. **Zapisywane pola w CompanyInfo:**
   - âœ… Address
   - âœ… PhoneNumber
   - âœ… Email
   - âœ… NIP
   - âœ… **REGON** (nowe!)
   - âœ… LegalForm
   - âœ… OpeningHours
   - âœ… Description
   - âœ… ExtraInfo
   - âœ… Lat, Lon (GPS)
   - âœ… SmsThanksText, SmsReminderText (x3)
   - âœ… EmailThanksText, EmailReminderText (x3)

4. **Potwierdzenie:**
   - Snackbar: "Ustawienia zostaÅ‚y zapisane" (Success)
   - BÅ‚Ä…d: "BÅ‚Ä…d podczas zapisywania: {message}" (Error)

---

## ğŸ”— Nawigacja

### **DostÄ™p z Panelu Owner:**

```
/admin/owner â†’ Karta "Ustawienia firmy" â†’ /admin/company-settings
```

### **Menu gÅ‚Ã³wne:**
```
Admin â†’ Company Settings
```

---

## ğŸ§ª Test Flow

### **Scenariusz testowy:**

1. **Login jako Owner**
   ```
   https://localhost:5016/login
   Role: Owner
   ```

2. **PrzejdÅº do ustawieÅ„:**
   ```
   https://localhost:5016/admin/company-settings
   ```

3. **WypeÅ‚nij dane:**
   ```
   Nazwa firmy:   WypoÅ¼yczalnia 'Narty Test' Sp. z o.o.
   Adres:         ul. Testowa 1/2, 00-000 Warszawa
   Telefon:       +48 123 456 789
   Email:         test@wypo.pl
   NIP:           1234567890
   REGON:         123456789
   Forma prawna:  Sp. z o.o.
   ```

4. **Zapisz:**
   ```
   Kliknij "Zapisz ustawienia"
   Oczekiwany: "Ustawienia zostaÅ‚y zapisane" âœ…
   ```

5. **Weryfikuj PDF:**
   - PrzeprowadÅº wypoÅ¼yczenie testowe
   - SprawdÅº PDF w emailu
   - Upewnij siÄ™ Å¼e dane firmy sÄ… w PDF! ğŸ“„

---

## ğŸ¯ UÅ¼ycie danych w systemie

### **Gdzie sÄ… wykorzystywane CompanyInfo:**

| Miejsce | Opis | Status |
|---------|------|--------|
| **PDF Contracts** | Dane firmy w sekcji "DANE WYPOÅ»YCZALNI" | âœ… DziaÅ‚a |
| **Email Footer** | Kontakt firmy w stopce emaili | âœ… DziaÅ‚a |
| **Stripe Webhooks** | Pobierane dla tenanta przy pÅ‚atnoÅ›ci | âœ… DziaÅ‚a |
| **SMS Templates** | Szablony z nazwÄ… firmy | ğŸ”„ TODO |
| **Faktury** | Dane firmy na fakturach | ğŸ”„ TODO |

---

## ğŸ“Š PrzykÅ‚ad dziaÅ‚ania

### **PRZED wypeÅ‚nieniem:**
```
PDF Footer:
SportRental | kontakt@sportrental.pl | +48 123 456 789
```

### **PO wypeÅ‚nieniu:**
```
PDF Header:
DANE WYPOÅ»YCZALNI
WypoÅ¼yczalnia 'Narty & Snowboard' Sp. z o.o.
Adres: ul. KrupÃ³wki 12/3, 34-500 Zakopane
NIP: 7362614562
REGON: 012345678
Email: kontakt@nartyzakopane.pl
Tel: +48 18 201 50 00

PDF Footer:
WypoÅ¼yczalnia 'Narty & Snowboard' Sp. z o.o. | 
Wygenerowano: 07.10.2025 00:14
kontakt@nartyzakopane.pl | +48 18 201 50 00
```

---

## ğŸš€ Deployment

### **Migracja bazy:**
```bash
# REGON juÅ¼ dodany w migracji
dotnet ef database update --project SportRental.Infrastructure --startup-project SportRental.Admin
```

### **Build i Run:**
```bash
# Build
dotnet build SportRental.Admin/SportRental.Admin.csproj

# Run
dotnet run --project SportRental.Admin
```

### **URL:**
```
https://localhost:5016/admin/company-settings
```

---

## ğŸ“‹ Checklist wdroÅ¼enia

- [x] Pole REGON dodane do modelu CompanyInfo
- [x] Migracja EF stworzona i uruchomiona
- [x] UI panel ma pole REGON
- [x] LoadData mapuje REGON
- [x] Save zapisuje REGON (update + create)
- [x] CompanyInfoDto ma REGON
- [x] Info box o PDF w UI
- [x] Build SportRental.Admin OK
- [x] PDF generator uÅ¼ywa CompanyInfo
- [x] Testy PDF przechodzÄ…

---

## ğŸ’¡ Tips dla Owner

### **Najlepsze praktyki:**

1. **WypeÅ‚nij wszystkie pola!**
   - Im wiÄ™cej danych, tym profesjonalniejsze umowy PDF

2. **SprawdÅº NIP i REGON:**
   - Upewnij siÄ™ Å¼e sÄ… poprawne
   - NIP: 10 cyfr
   - REGON: 9 lub 14 cyfr

3. **UÅ¼ywaj peÅ‚nego adresu:**
   - Ulica, numer, kod pocztowy, miasto
   - To bÄ™dzie w umowach dla klientÃ³w!

4. **Email i telefon:**
   - To gÅ‚Ã³wne kanaÅ‚y kontaktu w umowach
   - SprawdÅº czy sÄ… aktualne

5. **Przetestuj PDF:**
   - Po wypeÅ‚nieniu zrÃ³b testowe wypoÅ¼yczenie
   - SprawdÅº czy PDF wyglÄ…da OK

---

## ğŸ†˜ Troubleshooting

### **Problem: Dane nie zapisujÄ… siÄ™**
```
RozwiÄ…zanie:
1. SprawdÅº logi w konsoli przeglÄ…darki
2. SprawdÅº czy jesteÅ› zalogowany jako Owner
3. SprawdÅº connection string do bazy
```

### **Problem: PDF nie ma moich danych**
```
RozwiÄ…zanie:
1. SprawdÅº czy CompanyInfo istnieje w bazie
2. SELECT * FROM "CompanyInfos" WHERE "TenantId" = 'your-tenant-id'
3. SprawdÅº czy webhook pobiera CompanyInfo
```

### **Problem: REGON nie zapisuje siÄ™**
```
RozwiÄ…zanie:
1. SprawdÅº migracjÄ™: dotnet ef migrations list
2. Upewnij siÄ™ Å¼e AddREGONToCompanyInfo zostaÅ‚a zastosowana
3. SprawdÅº czy kolumna REGON istnieje w bazie
```

---

**Data:** 07.10.2025  
**Wersja:** 1.0  
**Status:** âœ… Production Ready  
**Autor:** AI Assistant  
