@using SportRental.Client.Services
@inject TenantService TenantService
@inject NavigationManager Navigation

<div class="flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg">
    @if (!string.IsNullOrEmpty(currentTenantName))
    {
        <div class="flex items-center gap-2">
            <span class="text-2xl">üè¢</span>
            <div class="flex flex-col">
                <span class="text-xs text-gray-500 dark:text-gray-400">Filtr wypo≈ºyczalni:</span>
                <span class="font-semibold text-sm">@currentTenantName</span>
            </div>
        </div>
        <button @onclick="ChangeTenant" class="ml-2 px-3 py-1 text-xs bg-purple-600 hover:bg-purple-700 text-white rounded transition">
            Zmie≈Ñ
        </button>
        <button @onclick="ClearFilter" class="ml-1 px-3 py-1 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded transition">
            Wszystkie
        </button>
    }
    else
    {
        <div class="flex items-center gap-2">
            <span class="text-2xl">üåç</span>
            <div class="flex flex-col">
                <span class="text-xs text-gray-500 dark:text-gray-400">Wy≈õwietlanie:</span>
                <span class="font-semibold text-sm">Wszystkie wypo≈ºyczalnie</span>
            </div>
        </div>
        <button @onclick="SelectTenant" class="ml-2 px-3 py-1 text-xs bg-purple-600 hover:bg-purple-700 text-white rounded transition">
            Filtruj
        </button>
    }
</div>

@code {
    private string? currentTenantName;

    protected override async Task OnInitializedAsync()
    {
        currentTenantName = await TenantService.GetSelectedTenantNameAsync();
    }

    private void SelectTenant()
    {
        Navigation.NavigateTo("/select-tenant");
    }

    private async Task ChangeTenant()
    {
        Navigation.NavigateTo("/select-tenant");
    }

    private async Task ClearFilter()
    {
        await TenantService.ClearSelectedTenantAsync();
        Navigation.NavigateTo("/", forceLoad: true);
    }
}
